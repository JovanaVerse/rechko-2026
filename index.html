<!DOCTYPE html>
<html lang="sr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RECHKO 2026</title>
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:-apple-system,sans-serif;background:linear-gradient(135deg,#EEF2FF,#C7D2FE);min-height:100vh;padding:.75rem;overflow-x:hidden}
@media(max-width:640px){body{padding:.5rem}}
.container{max-width:1200px;margin:0 auto;overflow-x:hidden}
.info-box{background:#D1FAE5;border:2px solid #10B981;border-radius:8px;padding:1rem;margin-bottom:1rem;color:#065F46;font-size:.9rem}
@media(max-width:640px){.info-box{padding:.75rem;font-size:.85rem}}
.game-link-box{margin-top:1rem;padding:1rem;background:white;border-radius:8px;border:2px solid #10B981}
@media(max-width:640px){.game-link-box{padding:.75rem}}
.game-link-box a{color:#2563EB;font-weight:600;text-decoration:none;font-size:1.1rem}
@media(max-width:640px){.game-link-box a{font-size:1rem}}
.status-box{background:white;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,.1);padding:1.5rem;margin-bottom:1rem}
@media(max-width:640px){.status-box{padding:1rem;border-radius:8px}}
.status-title{font-size:1.3rem;font-weight:bold;color:#1F2937;margin-bottom:1rem;text-align:center}
@media(max-width:640px){.status-title{font-size:1.1rem;margin-bottom:.75rem}}
.players-status{display:grid;grid-template-columns:1fr 1fr;gap:1rem}
@media(max-width:640px){.players-status{grid-template-columns:1fr;gap:.75rem}}
.player-card{padding:1.5rem;border-radius:12px;text-align:center;transition:all .3s;border:3px solid transparent}
@media(max-width:640px){.player-card{padding:1rem;border-radius:8px;border-width:2px}}
.player-card.solved{border-color:#10B981;background:#D1FAE5;animation:pulse 2s ease-in-out infinite}
.player-card.waiting{border-color:#F59E0B;background:#FEF3C7}
.player-name{font-size:1.5rem;font-weight:bold;margin-bottom:.5rem}
@media(max-width:640px){.player-name{font-size:1.2rem}}
.player-status{font-size:1rem;font-weight:600;margin-top:.5rem}
@media(max-width:640px){.player-status{font-size:.9rem}}
.player-emoji{font-size:3rem;margin:.5rem 0}
@media(max-width:640px){.player-emoji{font-size:2.5rem;margin:.3rem 0}}
@keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
.ready-banner{background:linear-gradient(135deg,#10B981,#059669);color:white;padding:1.5rem;border-radius:12px;text-align:center;margin-bottom:1rem;box-shadow:0 4px 6px rgba(0,0,0,.1);animation:slideIn .5s ease-out}
@media(max-width:640px){.ready-banner{padding:1rem;border-radius:8px}}
@keyframes slideIn{from{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}
.ready-banner h3{font-size:1.5rem;margin-bottom:.5rem}
@media(max-width:640px){.ready-banner h3{font-size:1.1rem}}
.ready-banner p{font-size:1.1rem}
@media(max-width:640px){.ready-banner p{font-size:.95rem}}
.header{background:white;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,.1);padding:1.5rem;margin-bottom:1.5rem}
@media(max-width:640px){.header{padding:1rem;margin-bottom:1rem}}
.header-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:1rem}
@media(max-width:640px){.header-top{margin-bottom:.75rem}}
.title{font-size:1.8rem;font-weight:bold;color:#1F2937}
@media(max-width:640px){.title{font-size:1.3rem}}
.months{display:flex;gap:.5rem;overflow-x:auto;padding-bottom:.5rem}
@media(max-width:640px){.months{gap:.3rem}}
.month-btn{padding:.75rem 1rem;border:none;border-radius:8px;font-weight:600;cursor:pointer;white-space:nowrap;transition:all .3s;font-size:.9rem}
@media(max-width:640px){.month-btn{padding:.5rem .75rem;font-size:.8rem}}
.month-btn.active{background:#2563EB;color:white;box-shadow:0 2px 4px rgba(37,99,235,.3)}
.month-btn:not(.active){background:#F3F4F6;color:#6B7280}
.scores-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1rem;margin-bottom:1.5rem}
@media(max-width:640px){.scores-grid{grid-template-columns:1fr;gap:.75rem;margin-bottom:1rem}}
.score-card{border-radius:12px;padding:1.5rem;color:white;box-shadow:0 4px 6px rgba(0,0,0,.1)}
@media(max-width:640px){.score-card{padding:1rem;border-radius:8px}}
.score-card h3{font-size:1.25rem;margin-bottom:.5rem}
@media(max-width:640px){.score-card h3{font-size:1.1rem}}
.score-card .points{font-size:2rem;font-weight:bold}
@media(max-width:640px){.score-card .points{font-size:1.5rem}}
.score-card .wins{font-size:1.1rem;margin-top:.5rem}
@media(max-width:640px){.score-card .wins{font-size:.95rem}}
.winner-banner{border-radius:12px;padding:1.5rem;color:white;text-align:center;margin-bottom:1.5rem;box-shadow:0 4px 6px rgba(0,0,0,.1)}
@media(max-width:640px){.winner-banner{padding:1rem;margin-bottom:1rem;border-radius:8px}}
.winner-banner h3{font-size:1.5rem;margin-bottom:.5rem}
@media(max-width:640px){.winner-banner h3{font-size:1.1rem}}
.calendar-section{background:white;border-radius:12px;box-shadow:0 4px 6px rgba(0,0,0,.1);padding:1.5rem}
@media(max-width:640px){.calendar-section{padding:.5rem;border-radius:8px}}
.calendar-title{font-size:1.5rem;font-weight:bold;color:#1F2937;margin-bottom:1rem}
@media(max-width:640px){.calendar-title{font-size:1rem;margin-bottom:.5rem}}
.calendar{display:grid;grid-template-columns:repeat(7,1fr);gap:.4rem;margin-bottom:1.5rem}
@media(max-width:640px){.calendar{gap:.15rem;margin-bottom:.75rem}}
.day-cell{aspect-ratio:1;border:2px solid #E5E7EB;border-radius:8px;cursor:pointer;transition:all .2s;position:relative;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:.3rem;min-height:65px}
@media(max-width:640px){.day-cell{min-height:48px;border-radius:4px;border-width:1px;padding:.15rem}}
.day-cell:hover{box-shadow:0 2px 8px rgba(0,0,0,.15);transform:scale(1.05)}
@media(max-width:640px){.day-cell:hover{transform:scale(1.02)}}
.day-cell.selected{border-color:#2563EB;background:#EFF6FF;transform:scale(1.05)}
@media(max-width:640px){.day-cell.selected{transform:scale(1.02)}}
.day-number{font-weight:bold;font-size:1rem;text-align:center}
@media(max-width:640px){.day-number{font-size:.75rem}}
.day-scores{font-size:.65rem;text-align:center;margin-top:.15rem}
@media(max-width:640px){.day-scores{font-size:.5rem;margin-top:.05rem;line-height:1.1}}
.delete-btn{position:absolute;top:2px;right:2px;background:none;border:none;cursor:pointer;padding:2px;font-size:.7rem}
@media(max-width:640px){.delete-btn{font-size:.6rem;top:0;right:0;padding:1px}}
.form-section{border-top:2px solid #E5E7EB;padding-top:1.5rem;margin-top:1.5rem}
.form-title{font-size:1.25rem;font-weight:bold;color:#1F2937;margin-bottom:1rem}
.form-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1rem;margin-bottom:1rem}
.form-group label{display:block;font-size:.9rem;font-weight:600;color:#374151;margin-bottom:.5rem}
.winner-display{width:100%;padding:1rem;border:2px solid #D1D5DB;border-radius:8px;background:#F9FAFB;font-weight:600;font-size:1.1rem;text-align:center}
.form-buttons{display:flex;gap:.75rem}
.btn{flex:1;padding:.875rem;border:none;border-radius:8px;font-weight:600;font-size:1rem;cursor:pointer;transition:all .2s}
.btn-primary{background:#2563EB;color:white}
.btn-primary:hover{background:#1D4ED8}
.btn-secondary{background:#D1D5DB;color:#374151}
.btn-secondary:hover{background:#9CA3AF}
.status-controls{margin-top:1rem;display:flex;gap:.5rem;justify-content:center;flex-wrap:wrap}
@media(max-width:640px){.status-controls{gap:.4rem;margin-top:.75rem}}
.status-btn{padding:.5rem 1rem;border:2px solid #D1D5DB;border-radius:8px;background:white;font-weight:600;cursor:pointer;transition:all .2s;font-size:.9rem}
@media(max-width:640px){.status-btn{padding:.4rem .7rem;font-size:.8rem;border-width:1.5px}}
.status-btn:hover{background:#F3F4F6}
.status-btn.active{background:#10B981;color:white;border-color:#10B981}
.modal-overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.7);display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem;animation:fadeIn .3s ease-out}
@media(max-width:640px){.modal-overlay{padding:.5rem}}
@keyframes fadeIn{from{opacity:0}to{opacity:1}}
.modal-content{background:white;border-radius:16px;max-width:600px;width:100%;max-height:90vh;overflow-y:auto;box-shadow:0 20px 25px -5px rgba(0,0,0,0.3);animation:slideUp .3s ease-out}
@media(max-width:640px){.modal-content{border-radius:12px;max-height:85vh}}
@keyframes slideUp{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
.modal-header{background:linear-gradient(135deg,#2563EB,#1D4ED8);color:white;padding:1.5rem;border-radius:16px 16px 0 0;text-align:center}
@media(max-width:640px){.modal-header{padding:1rem;border-radius:12px 12px 0 0}}
.modal-header h2{font-size:1.5rem;margin-bottom:.5rem}
@media(max-width:640px){.modal-header h2{font-size:1.2rem}}
.modal-header p{font-size:1rem;opacity:.9}
@media(max-width:640px){.modal-header p{font-size:.9rem}}
.modal-body{padding:1.5rem}
@media(max-width:640px){.modal-body{padding:1rem}}
.modal-close{position:absolute;top:1rem;right:1rem;background:rgba(255,255,255,0.2);color:white;border:none;width:36px;height:36px;border-radius:50%;cursor:pointer;font-size:1.5rem;display:flex;align-items:center;justify-content:center;transition:all .2s}
@media(max-width:640px){.modal-close{top:.75rem;right:.75rem;width:32px;height:32px;font-size:1.3rem}}
.modal-close:hover{background:rgba(255,255,255,0.3);transform:scale(1.1)}
</style>
</head>
<body>
<div class="container">
<div class="info-box">
<strong style="display:block;margin-bottom:.5rem">‚úÖ Firebase POVEZAN!</strong>
Aplikacija koristi online bazu podataka. Svi koji otvore ovaj fajl dele iste podatke u realnom vremenu! üöÄ<br><br>
<strong style="display:block;margin-bottom:.5rem">üìù VA≈ΩNO:</strong>MANJE poku≈°aja = bolje! Ko ima MANJE poena, taj POBEDI. üèÜ
<div class="game-link-box">
<strong style="color:#065F46;display:block;margin-bottom:.5rem">üéÆ IGRAJ RECHKO:</strong>
<a href="https://rechko.com/" target="_blank">üëâ rechko.com</a>
<div style="margin-top:.5rem;font-size:.9rem;color:#065F46" id="timer">‚è∞ Uƒçitavanje...</div>
</div>
</div>

<div id="readyBanner" style="display:none"></div>

<div class="status-box">
<div class="status-title">üìä Status igraƒça za danas</div>
<div id="statusContent">
<div class="players-status">
<div class="player-card" id="jokaCard">
<div class="player-name" style="color:#8B4556">üò± JOKA</div>
<div class="player-emoji" id="jokaEmoji">‚è≥</div>
<div class="player-status" id="jokaStatus">Uƒçitavanje...</div>
<div class="status-controls">
<button class="status-btn" onclick="markSolved('joka')">‚úÖ Re≈°ila</button>
<button class="status-btn" onclick="markWaiting('joka')">‚è≥ ƒåeka</button>
<button class="status-btn" onclick="markFailed('joka')">‚ùå Nije re≈°ila</button>
</div>
</div>
<div class="player-card" id="pajaCard">
<div class="player-name" style="color:#3C4C24">ü§Ø PAJA</div>
<div class="player-emoji" id="pajaEmoji">‚è≥</div>
<div class="player-status" id="pajaStatus">Uƒçitavanje...</div>
<div class="status-controls">
<button class="status-btn" onclick="markSolved('paja')">‚úÖ Re≈°io</button>
<button class="status-btn" onclick="markWaiting('paja')">‚è≥ ƒåeka</button>
<button class="status-btn" onclick="markFailed('paja')">‚ùå Nije re≈°io</button>
</div>
</div>
</div>
</div>
</div>

<div class="header">
<div class="header-top">
<div class="title">üèÜ RECHKO 2026</div>
<button onclick="reset()" style="padding:.5rem 1rem;background:#EF4444;color:white;border:none;border-radius:8px;cursor:pointer;font-weight:600;font-size:.9rem">üóëÔ∏è Reset Sve</button>
</div>
<div class="months" id="months"></div>
</div>
<div id="yearly"></div>
<div class="scores-grid">
<div class="score-card" style="background-color:#8B4556">
<h3>üò± JOKA</h3>
<div class="points"><span id="jt">0</span> poena</div>
<div class="wins"><span id="jw">0</span> pobeda</div>
</div>
<div class="score-card" style="background-color:#3C4C24">
<h3>ü§Ø PAJA</h3>
<div class="points"><span id="pt">0</span> poena</div>
<div class="wins"><span id="pw">0</span> pobeda</div>
</div>
</div>
<div id="monthly"></div>
<div id="entryModal" style="display:none"></div>
<div class="calendar-section">
<div class="calendar-title" id="title">Januar - Dnevni Rezultati</div>
<div class="calendar" id="cal"></div>
</div>
</div>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<script>
// ========== KONFIGURACIJA - MENJAJ OVDE ==========
const cfg={
api:"AIzaSyATrCpqicc3HHCOpc6Pv-edqWlgpSiM-XU",
domain:"rechko-2026-f9959.firebaseapp.com",
db:"https://rechko-2026-f9959-default-rtdb.europe-west1.firebasedatabase.app",
proj:"rechko-2026-f9959",
storage:"rechko-2026-f9959.firebasestorage.app",
msg:"524255667916",
appId:"1:524255667916:web:2ba7a1961ef6dacaba0469",
jokaColor:"#8B4556",
pajaColor:"#3C4C24",
jokaEmoji:"üò±",
pajaEmoji:"ü§Ø"
};
// ==================================================

const M=['Januar','Februar','Mart','April','Maj','Jun','Jul','Avgust','Septembar','Oktobar','Novembar','Decembar'];
const D=[31,28,31,30,31,30,31,31,30,31,30,31];
let db,use=0,m=new Date().getMonth(),d=null,S={},todayStatus={joka:'waiting',paja:'waiting'};

try{
firebase.initializeApp({apiKey:cfg.api,authDomain:cfg.domain,databaseURL:cfg.db,projectId:cfg.proj,storageBucket:cfg.storage,messagingSenderId:cfg.msg,appId:cfg.appId});
db=firebase.database();use=1;console.log('‚úÖ Firebase OK');
}catch(e){console.error('‚ùå Firebase error:',e)}

function load(){
if(use){
db.ref('rechko2026').on('value',s=>{S=s.val()||{};ui()});
db.ref('todayStatus').on('value',s=>{
const data=s.val();
if(data&&data.date===getTodayKey()){
todayStatus=data;
}else{
todayStatus={joka:'waiting',paja:'waiting',date:getTodayKey()};
}
updateStatus();
});
}else try{
const x=localStorage.getItem('rechkoScores2026');
if(x)S=JSON.parse(x);
const st=localStorage.getItem('rechkoTodayStatus');
if(st){
const data=JSON.parse(st);
if(data.date===getTodayKey())todayStatus=data;
}
ui();updateStatus();
}catch(e){}
}

function save(){
if(use)db.ref('rechko2026').set(S);
else try{localStorage.setItem('rechkoScores2026',JSON.stringify(S))}catch(e){}
}

function saveStatus(){
todayStatus.date=getTodayKey();
if(use)db.ref('todayStatus').set(todayStatus);
else try{localStorage.setItem('rechkoTodayStatus',JSON.stringify(todayStatus))}catch(e){}
}

function getTodayKey(){
const n=new Date();
// Posle 23h raƒçunamo da je "danas" zapravo sutra≈°nji dan (jer poƒçinje nova Rechko reƒç)
if(n.getHours()>=23){
const tomorrow=new Date(n);
tomorrow.setDate(tomorrow.getDate()+1);
return`${tomorrow.getFullYear()}-${String(tomorrow.getMonth()+1).padStart(2,'0')}-${String(tomorrow.getDate()).padStart(2,'0')}`;
}
return`${n.getFullYear()}-${String(n.getMonth()+1).padStart(2,'0')}-${String(n.getDate()).padStart(2,'0')}`;
}

function ui(){cal();tot();mon();yr()}

function updateStatus(){
const today=new Date();
const currentDay=today.getDate();
const currentMonth=today.getMonth();
const hasResults=S[currentMonth]&&S[currentMonth][currentDay];

const statusBox=document.querySelector('.status-box');
const statusContent=document.getElementById('statusContent');
const readyBanner=document.getElementById('readyBanner');

// Ako ima rezultate za danas, prika≈æi pobednika
if(hasResults){
const result=S[currentMonth][currentDay];
let winnerColor,winnerText,winnerEmoji,winnerDetails;
if(result.winner==='Joka'){
winnerColor=cfg.jokaColor;
winnerText='JOKA JE POBEDILA!';
winnerEmoji='üò±üèÜ';
winnerDetails=`Joka: ${result.joka} poku≈°aj${result.joka>1?'a':''} | Paja: ${result.paja===999?'‚ùå Nije re≈°io':result.paja+' poku≈°aj'+(result.paja>1?'a':'')}`;
}else if(result.winner==='Paja'){
winnerColor=cfg.pajaColor;
winnerText='PAJA JE POBEDIO!';
winnerEmoji='ü§ØüèÜ';
winnerDetails=`Joka: ${result.joka===999?'‚ùå Nije re≈°ila':result.joka+' poku≈°aj'+(result.joka>1?'a':'')} | Paja: ${result.paja} poku≈°aj${result.paja>1?'a':''}`;
}else{
winnerColor='#6B7280';
// Proveri da li je nere≈°eno jer niko nije re≈°io ili jer imaju isti broj
if(result.joka===999&&result.paja===999){
winnerText='NIKO NIJE RE≈†IO!';
winnerEmoji='ü§ù';
winnerDetails='Oba igraƒça nisu uspela da re≈°e - 0 poena za oba';
}else{
winnerText='NERE≈†ENO - ISTI BROJ!';
winnerEmoji='ü§ù';
winnerDetails=`Oba igraƒça: ${result.joka} poku≈°aj${result.joka>1?'a':''} - Bodovi se raƒçunaju!`;
}
}

statusBox.querySelector('.status-title').textContent='‚úÖ Rezultati za danas uneti!';
statusContent.innerHTML=`
<div style="background:linear-gradient(135deg,${winnerColor},${winnerColor}dd);color:white;padding:2rem;border-radius:12px;text-align:center;animation:slideIn .5s ease-out">
<div style="font-size:3rem;margin-bottom:1rem">${winnerEmoji}</div>
<div style="font-size:1.8rem;font-weight:bold;margin-bottom:.5rem">${winnerText}</div>
<div style="font-size:1.1rem;opacity:.9">
${winnerDetails}
</div>
<div style="margin-top:1.5rem;font-size:1rem;opacity:.8">
‚è∞ ƒåeka se nova Rechko reƒç sutra u 23h...
</div>
</div>`;
readyBanner.style.display='none';
return;
}

// Inaƒçe prika≈æi status igraƒça
statusBox.querySelector('.status-title').textContent='üìä Status igraƒça za danas';
const jokaCard=document.getElementById('jokaCard');
const pajaCard=document.getElementById('pajaCard');

// Ako ne postoje kartice, vrati ih
if(!jokaCard||!pajaCard){
statusContent.innerHTML=`
<div class="players-status">
<div class="player-card" id="jokaCard">
<div class="player-name" style="color:#8B4556">üò± JOKA</div>
<div class="player-emoji" id="jokaEmoji">‚è≥</div>
<div class="player-status" id="jokaStatus">Uƒçitavanje...</div>
<div class="status-controls">
<button class="status-btn" onclick="markSolved('joka')">‚úÖ Re≈°ila</button>
<button class="status-btn" onclick="markWaiting('joka')">‚è≥ ƒåeka</button>
<button class="status-btn" onclick="markFailed('joka')">‚ùå Nije re≈°ila</button>
</div>
</div>
<div class="player-card" id="pajaCard">
<div class="player-name" style="color:#3C4C24">ü§Ø PAJA</div>
<div class="player-emoji" id="pajaEmoji">‚è≥</div>
<div class="player-status" id="pajaStatus">Uƒçitavanje...</div>
<div class="status-controls">
<button class="status-btn" onclick="markSolved('paja')">‚úÖ Re≈°io</button>
<button class="status-btn" onclick="markWaiting('paja')">‚è≥ ƒåeka</button>
<button class="status-btn" onclick="markFailed('paja')">‚ùå Nije re≈°io</button>
</div>
</div>
</div>`;
}

const jokaEmoji=document.getElementById('jokaEmoji');
const pajaEmoji=document.getElementById('pajaEmoji');
const jokaStatus=document.getElementById('jokaStatus');
const pajaStatus=document.getElementById('pajaStatus');
const jokaCardEl=document.getElementById('jokaCard');
const pajaCardEl=document.getElementById('pajaCard');

if(todayStatus.joka==='solved'){
jokaCardEl.className='player-card solved';
jokaEmoji.textContent='‚úÖ';
jokaStatus.innerHTML='<span style="color:#10B981">Re≈°ila danas!</span>';
}else if(todayStatus.joka==='failed'){
jokaCardEl.className='player-card solved';
jokaCardEl.style.borderColor='#EF4444';
jokaCardEl.style.background='#FEE2E2';
jokaEmoji.textContent='‚ùå';
jokaStatus.innerHTML='<span style="color:#EF4444">Nije re≈°ila</span>';
}else{
jokaCardEl.className='player-card waiting';
jokaCardEl.style.borderColor='#F59E0B';
jokaCardEl.style.background='#FEF3C7';
jokaEmoji.textContent='‚è≥';
jokaStatus.innerHTML='<span style="color:#F59E0B">Jo≈° ƒçeka...</span>';
}

if(todayStatus.paja==='solved'){
pajaCardEl.className='player-card solved';
pajaEmoji.textContent='‚úÖ';
pajaStatus.innerHTML='<span style="color:#10B981">Re≈°io danas!</span>';
}else if(todayStatus.paja==='failed'){
pajaCardEl.className='player-card solved';
pajaCardEl.style.borderColor='#EF4444';
pajaCardEl.style.background='#FEE2E2';
pajaEmoji.textContent='‚ùå';
pajaStatus.innerHTML='<span style="color:#EF4444">Nije re≈°io</span>';
}else{
pajaCardEl.className='player-card waiting';
pajaCardEl.style.borderColor='#F59E0B';
pajaCardEl.style.background='#FEF3C7';
pajaEmoji.textContent='‚è≥';
pajaStatus.innerHTML='<span style="color:#F59E0B">Jo≈° ƒçeka...</span>';
}

// Proveri da li oba igraƒça imaju finalan status (solved ili failed)
const jokaDone=todayStatus.joka==='solved'||todayStatus.joka==='failed';
const pajaDone=todayStatus.paja==='solved'||todayStatus.paja==='failed';

if(jokaDone&&pajaDone){
readyBanner.className='ready-banner';
readyBanner.style.display='block';
readyBanner.innerHTML='<h3>üéâ OBA IGRAƒåA SU ZAVR≈†ILA! üéâ</h3><p>Mo≈æe≈° da unese≈° rezultate za danas! ‚¨áÔ∏è</p>';
}else{
readyBanner.style.display='none';
}
}

window.markSolved=function(player){
todayStatus[player]='solved';
saveStatus();
updateStatus();

// Automatski otvori modal kada oba zavr≈°e (solved ili failed)
const jokaDone=todayStatus.joka==='solved'||todayStatus.joka==='failed';
const pajaDone=todayStatus.paja==='solved'||todayStatus.paja==='failed';
if(jokaDone&&pajaDone){
const today=new Date();
const currentDay=today.getDate();
const currentMonth=today.getMonth();
const hasResults=S[currentMonth]&&S[currentMonth][currentDay];
if(!hasResults){
m=currentMonth;
d=currentDay;
months();
ui();
setTimeout(()=>openModal(),300);
}
}
}

window.markWaiting=function(player){
todayStatus[player]='waiting';
saveStatus();
updateStatus();
}

window.markFailed=function(player){
todayStatus[player]='failed';
saveStatus();
updateStatus();

// Automatski otvori modal kada oba zavr≈°e (solved ili failed)
const jokaDone=todayStatus.joka==='solved'||todayStatus.joka==='failed';
const pajaDone=todayStatus.paja==='solved'||todayStatus.paja==='failed';
if(jokaDone&&pajaDone){
const today=new Date();
const currentDay=today.getDate();
const currentMonth=today.getMonth();
const hasResults=S[currentMonth]&&S[currentMonth][currentDay];
if(!hasResults){
m=currentMonth;
d=currentDay;
months();
ui();
setTimeout(()=>openModal(),300);
}
}
}

function months(){
document.getElementById('months').innerHTML=M.map((n,i)=>{
const dt=S[i]||{},c=Object.keys(dt).length===D[i];
let st='';
if(c){
let jt=0,pt=0;
Object.values(dt).forEach(x=>{jt+=x.joka===999?0:(x.joka||0);pt+=x.paja===999?0:(x.paja||0)});
const bg=jt<pt?cfg.jokaColor:pt<jt?cfg.pajaColor:'#6B7280';
st=`style="background:${bg};color:white"`;
}
return`<button class="month-btn ${i===m?'active':''}"${st}onclick="sel(${i})">${n}</button>`;
}).join('');
}

function sel(i){m=i;d=null;months();ui()}

function cal(){
const e=document.getElementById('cal');
document.getElementById('title').textContent=`${M[m]} - Dnevni Rezultati`;
let h='';
for(let i=1;i<=D[m];i++){
const ds=S[m]?.[i],s=d===i;
let bg='',tx='#374151';
if(ds&&!s){
if(ds.winner==='Joka'){bg=`background-color:${cfg.jokaColor}`;tx='white'}
else if(ds.winner==='Paja'){bg=`background-color:${cfg.pajaColor}`;tx='white'}
else{bg='background-color:#6B7280';tx='white'}
}
h+=`<div class="day-cell ${s?'selected':''}"style="${bg}"onclick="pick(${i})">`;
h+=`<div class="day-number"style="color:${tx}">${i}</div>`;
if(ds){
h+=`<div class="day-scores"style="color:${s?'#374151':tx}">`;
h+=`<div style="color:${s?cfg.jokaColor:tx}">J: ${ds.joka===999?'‚ùå':ds.joka}</div>`;
h+=`<div style="color:${s?cfg.pajaColor:tx}">P: ${ds.paja===999?'‚ùå':ds.paja}</div>`;
h+=`</div><button class="delete-btn"style="color:${s?'#EF4444':tx}"onclick="del(${i},event)">‚úï</button>`;
}
h+='</div>';
}
e.innerHTML=h;
}

function pick(i){d=i;cal();openModal()}

function openModal(){
if(!d)return;
const modal=document.getElementById('entryModal');
const ds=S[m]?.[d],js=ds?.joka||'',ps=ds?.paja||'';
modal.style.display='flex';
modal.innerHTML=`
<div class="modal-overlay" onclick="closeModalOnOverlay(event)">
<div class="modal-content" onclick="event.stopPropagation()">
<div class="modal-header" style="position:relative">
<button class="modal-close" onclick="closeModal()">√ó</button>
<h2>üìÖ ${M[m]} - Dan ${d}</h2>
<p>Unesi rezultate za dana≈°nju Rechko reƒç</p>
</div>
<div class="modal-body">
<div class="form-grid">
<div class="form-group">
<label>üò± Joka - Broj poku≈°aja</label>
<select id="ji" onchange="prev()" style="width:100%;padding:.75rem;border:2px solid #D1D5DB;border-radius:8px;font-size:1rem;background:white">
<option value="">Izaberi...</option>
${[1,2,3,4,5,6].map(n=>`<option value="${n}"${js==n?'selected':''}>${n} poku≈°aj${n>1?'a':''}</option>`).join('')}
<option value="999"${js==999?'selected':''}>Nisam re≈°ila</option>
</select>
</div>
<div class="form-group">
<label>ü§Ø Paja - Broj poku≈°aja</label>
<select id="pi" onchange="prev()" style="width:100%;padding:.75rem;border:2px solid #D1D5DB;border-radius:8px;font-size:1rem;background:white">
<option value="">Izaberi...</option>
${[1,2,3,4,5,6].map(n=>`<option value="${n}"${ps==n?'selected':''}>${n} poku≈°aj${n>1?'a':''}</option>`).join('')}
<option value="999"${ps==999?'selected':''}>Nisam re≈°io</option>
</select>
</div>
</div>
<div class="form-group" style="margin:1.5rem 0">
<label>üèÜ Pobednik (automatski - MANJE je BOLJE!)</label>
<div class="winner-display" id="win">ü§ù Nere≈°eno</div>
</div>
<div class="form-buttons">
<button class="btn btn-primary" onclick="sav()">üíæ Saƒçuvaj Rezultate</button>
<button class="btn btn-secondary" onclick="closeModal()">‚ùå Otka≈æi</button>
</div>
</div>
</div>
</div>`;
prev();
document.body.style.overflow='hidden'; // Prevent background scroll
}

function closeModal(){
const modal=document.getElementById('entryModal');
modal.style.display='none';
d=null;
cal();
document.body.style.overflow=''; // Restore scroll
}

function closeModalOnOverlay(e){
if(e.target.classList.contains('modal-overlay'))closeModal();
}

window.prev=function(){
const j=parseInt(document.getElementById('ji').value)||0;
const p=parseInt(document.getElementById('pi').value)||0;
const e=document.getElementById('win');
if(j===999&&p===999){e.textContent='ü§ù Nere≈°eno (niko nije re≈°io - 0 poena za oba)';e.style.background='#F9FAFB';e.style.color='#6B7280'}
else if(j===999){e.textContent=`${cfg.pajaEmoji} Paja (Joka nije re≈°ila!)`;e.style.background='#F0FDF4';e.style.color=cfg.pajaColor}
else if(p===999){e.textContent=`${cfg.jokaEmoji} Joka (Paja nije re≈°io!)`;e.style.background='#FEE2E2';e.style.color=cfg.jokaColor}
else if(j<p&&j>0){e.textContent=`${cfg.jokaEmoji} Joka (manje poku≈°aja!)`;e.style.background='#FEE2E2';e.style.color=cfg.jokaColor}
else if(p<j&&p>0){e.textContent=`${cfg.pajaEmoji} Paja (manje poku≈°aja!)`;e.style.background='#F0FDF4';e.style.color=cfg.pajaColor}
else if(j===p&&j>0){e.textContent='ü§ù Nere≈°eno (isti broj poku≈°aja - bodovi se raƒçunaju)';e.style.background='#F9FAFB';e.style.color='#6B7280'}
else{e.textContent='ü§ù Nere≈°eno';e.style.background='#F9FAFB';e.style.color='#6B7280'}
}

window.sav=function(){
const j=parseInt(document.getElementById('ji').value)||0;
const p=parseInt(document.getElementById('pi').value)||0;
if(j===0||p===0){alert('‚ö†Ô∏è Molim te izaberi broj poku≈°aja za oba igraƒça!');return}
let w='Nere≈°eno';
if(j===999&&p!==999)w='Paja';
else if(p===999&&j!==999)w='Joka';
else if(j<p)w='Joka';
else if(p<j)w='Paja';
if(!S[m])S[m]={};
S[m][d]={joka:j,paja:p,winner:w};
save();

// Reset status za sledeƒái dan - ali tek posle prikaza pobednika
const today=new Date();
if(today.getDate()===d&&today.getMonth()===m){
// Ne resetuj odmah, samo zatvori modal i prika≈æi winner screen
closeModal();
updateStatus(); // Ovo ƒáe prikazati winner screen
}else{
closeModal();
}

const dt=S[m]||{},c=Object.keys(dt).length===D[m];
if(c&&m<11)setTimeout(()=>{alert(`üéâ ${M[m]} je zavr≈°en! Prelazimo na ${M[m+1]}!`);m++;months();ui()},500);
else ui();
}

window.del=function(i,e){
e.stopPropagation();
if(S[m]){delete S[m][i];if(Object.keys(S[m]).length===0)delete S[m]}
save();ui();
}

window.reset=function(){
if(confirm('‚ö†Ô∏è Da li si sigurna da ≈æeli≈° da obri≈°e≈° SVE podatke?\n\nOvo ne mo≈æe da se vrati!')){
S={};
todayStatus={joka:'waiting',paja:'waiting',date:getTodayKey()};
save();
saveStatus();
alert('‚úÖ Svi podaci i statusi su obrisani!');
ui();
updateStatus();
}
}

function tot(){
const dt=S[m]||{};
let jt=0,pt=0,jw=0,pw=0;
Object.values(dt).forEach(x=>{
// 999 = nije re≈°io/re≈°ila, ≈°to se raƒçuna kao 0 poena (ne dodaje se u ukupan zbir)
jt+=x.joka===999?0:(x.joka||0);
pt+=x.paja===999?0:(x.paja||0);
if(x.winner==='Joka')jw++;
if(x.winner==='Paja')pw++;
});
document.getElementById('jt').textContent=jt;
document.getElementById('pt').textContent=pt;
document.getElementById('jw').textContent=jw;
document.getElementById('pw').textContent=pw;
}

function mon(){
const dt=S[m]||{},c=Object.keys(dt).length===D[m];
const e=document.getElementById('monthly');
if(!c){e.style.display='none';return}
let jt=0,pt=0;
Object.values(dt).forEach(x=>{jt+=x.joka===999?0:(x.joka||0);pt+=x.paja===999?0:(x.paja||0)});
let g,t,f;
if(jt<pt){g=`linear-gradient(to right,${cfg.jokaColor},#6B3444)`;t='üèÜ POBEDNIK MESECA: JOKA üèÜ';f=`Manje poku≈°aja: ${pt-jt} razlika`}
else if(pt<jt){g=`linear-gradient(to right,${cfg.pajaColor},#2C3C18)`;t='üèÜ POBEDNIK MESECA: PAJA üèÜ';f=`Manje poku≈°aja: ${jt-pt} razlika`}
else{g='linear-gradient(to right,#6B7280,#4B5563)';t='ü§ù MESEC JE NERE≈†EN ü§ù';f=`Oba igraƒça: ${jt} poku≈°aja`}
e.className='winner-banner';e.style.background=g;e.style.display='block';
e.innerHTML=`<h3>${t}</h3><p style="font-size:1.1rem">${f}</p>`;
}

function yr(){
const e=document.getElementById('yearly');
let jw=0,pw=0,cm=0;
for(let i=0;i<12;i++){
const dt=S[i]||{};
if(Object.keys(dt).length===D[i]){
cm++;
let jt=0,pt=0;
Object.values(dt).forEach(x=>{jt+=x.joka===999?0:(x.joka||0);pt+=x.paja===999?0:(x.paja||0)});
if(jt<pt)jw++;else if(pt<jt)pw++;
}
}
if(cm===0){e.style.display='none';return}
let g,t,s;
if(jw>pw){g=`linear-gradient(to right,${cfg.jokaColor},#6B3444)`;t=cm===12?'üéä POBEDNIK GODINE 2026: JOKA üéä':'üëë JOKA VODI U GODINI üëë';s=`${jw} meseci pobeda (Paja: ${pw})`}
else if(pw>jw){g=`linear-gradient(to right,${cfg.pajaColor},#2C3C18)`;t=cm===12?'üéä POBEDNIK GODINE 2026: PAJA üéä':'üëë PAJA VODI U GODINI üëë';s=`${pw} meseci pobeda (Joka: ${jw})`}
else{g='linear-gradient(to right,#6B7280,#4B5563)';t=cm===12?'üéä GODINA 2026 JE NERE≈†ENA üéä':'‚öñÔ∏è GODINA JE IZJEDNAƒåENA ‚öñÔ∏è';s=`Oba po ${jw} meseci pobeda`}
e.className='winner-banner';e.style.background=g;e.style.display='block';e.style.marginBottom='1.5rem';
e.innerHTML=`<h3>${t}</h3><p style="font-size:1.1rem">${s}</p><p style="font-size:.9rem;margin-top:.5rem;opacity:.9">Zavr≈°eno meseci: ${cm}/12</p>`;
}

function tmr(){
const n=new Date(),x=new Date();
x.setHours(23,0,0,0);
if(n>=x)x.setDate(x.getDate()+1);
const df=x-n,h=Math.floor(df/3600000),mn=Math.floor((df%3600000)/60000),s=Math.floor((df%60000)/1000);
const e=document.getElementById('timer');
if(e)e.innerHTML=h===0&&mn<5?`‚è∞ Nova reƒç za <strong style="color:#EF4444">${mn}m ${s}s</strong> üî•`:`‚è∞ Nova reƒç za: <strong>${h}h ${mn}m</strong>`;
}

// Reset statusa u 23h (kada poƒçinje nova Rechko reƒç)
function checkNewWord(){
const now=new Date();
// Proveri da li je promenjen dan (posle 23h)
const currentKey=getTodayKey();
if(todayStatus.date!==currentKey){
todayStatus={joka:'waiting',paja:'waiting',date:currentKey};
saveStatus();
updateStatus();
ui(); // Osve≈æi UI da prika≈æe novi dan u kalendaru
}
}

load();months();tmr();
setInterval(tmr,1000);
setInterval(checkNewWord,10000); // Provera svakih 10 sekundi za novu reƒç
</script>
</body>
</html>
